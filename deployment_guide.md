# –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è (Deployment Guide)

–¶–µ–π —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å –ø–æ–∫—Ä–æ–∫–æ–≤—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫—É –≤–∞—à–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.

## 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª—ñ–≤ (–õ–æ–∫–∞–ª—å–Ω–æ)

–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∞—Ä—Ö—ñ–≤ –∑ —Ñ–∞–π–ª–∞–º–∏ –ø—Ä–æ–µ–∫—Ç—É, –≤–∏–∫–ª—é—á–∞—é—á–∏ –≤–∞–∂–∫—ñ –ø–∞–ø–∫–∏ (`node_modules`) —Ç–∞ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ (—è–∫—â–æ –≤–æ–Ω–∏ –Ω–µ –≤ `.env`).

### –í–∞—Ä—ñ–∞–Ω—Ç –ê: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Ä—Ö—ñ–≤—É (—è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–∏–π `tar`)
–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü—é –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ (PowerShell –∞–±–æ CMD) –≤ –ø–∞–ø—Ü—ñ –ø—Ä–æ–µ–∫—Ç—É:
```powershell
tar -czvf deploy.tar.gz --exclude=node_modules --exclude=.git --exclude=backups --exclude=data .
```

### –í–∞—Ä—ñ–∞–Ω—Ç –ë: –†—É—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
1. –í–∏–¥—ñ–ª—ñ—Ç—å —É—Å—ñ —Ñ–∞–π–ª–∏ –≤ –ø–∞–ø—Ü—ñ –ø—Ä–æ–µ–∫—Ç—É.
2. –ó–Ω—ñ–º—ñ—Ç—å –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –∑ –ø–∞–ø–æ–∫:
   - `node_modules` (—É –∫–æ—Ä–µ–Ω—ñ, –∞ —Ç–∞–∫–æ–∂ —É `client/` —Ç–∞ `server/`, —è–∫—â–æ —î)
   - `.git`
   - `backups`
   - `data`
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –ø—Ä–∞–≤—É –∫–Ω–æ–ø–∫—É –º–∏—à—ñ -> "–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–æ" -> "–°—Ç–∏—Å–Ω—É—Ç–∞ –ø–∞–ø–∫–∞ (ZIP)" (–∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ WinRAR/7-Zip).
4. –ù–∞–∑–≤—ñ—Ç—å —Ñ–∞–π–ª `deploy.zip`.

## 2. –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `scp` (–∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫) –∞–±–æ –ø—Ä–æ–≥—Ä–∞–º—É —Ç–∏–ø—É **WinSCP** —á–∏ **FileZilla**.

### –ß–µ—Ä–µ–∑ WinSCP / FileZilla (–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è –Ω–æ–≤–∞—á–∫—ñ–≤)
1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ –≤–∞—à–æ–≥–æ —Å–µ—Ä–≤–µ—Ä—É (IP, –ª–æ–≥—ñ–Ω `root` –∞–±–æ –≤–∞—à –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –ø–∞—Ä–æ–ª—å/–∫–ª—é—á).
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –¥–ª—è –ø—Ä–æ–µ–∫—Ç—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `/opt/n8n-backup`.
3. –ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å —Ñ–∞–π–ª `deploy.zip` (–∞–±–æ `deploy.tar.gz`) –∑ –ª—ñ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ (–≤–∞—à –∫–æ–º–ø'—é—Ç–µ—Ä) –≤ –ø—Ä–∞–≤—É (—Å–µ—Ä–≤–µ—Ä).

### –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫ (SCP)
```bash
scp deploy.tar.gz user@your-server-ip:/opt/n8n-backup/
```

## 3. –ó–∞–ø—É—Å–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ SSH:
```bash
ssh user@your-server-ip
```

–ü–µ—Ä–µ–π–¥—ñ—Ç—å —É –ø–∞–ø–∫—É —Ç–∞ —Ä–æ–∑–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö—ñ–≤:

**–î–ª—è .zip:**
```bash
cd /opt/n8n-backup
# –Ø–∫—â–æ unzip –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: apt install unzip
unzip deploy.zip
```

**–î–ª—è .tar.gz:**
```bash
mkdir -p /opt/n8n-backup
mv deploy.tar.gz /opt/n8n-backup/
cd /opt/n8n-backup
tar -xzvf deploy.tar.gz
```

## 4. –ó–∞–ø—É—Å–∫ Docker Compose

–¢–µ–ø–µ—Ä, –∫–æ–ª–∏ —Ñ–∞–π–ª–∏ –Ω–∞ –º—ñ—Å—Ü—ñ, –∑–∞–ø—É—Å—Ç—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç:

```bash
docker-compose up -d --build
```

- `-d`: –ó–∞–ø—É—Å–∫ —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ.
- `--build`: –ü—Ä–∏–º—É—Å–æ–≤–∞ –ø–µ—Ä–µ–∑–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—É (–≤–∞–∂–ª–∏–≤–æ –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –∫–æ–¥—É).

## 5. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏:
```bash
docker-compose ps
```

–í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å `Up`.

## 6. –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º (Troubleshooting)

### –ü–æ–º–∏–ª–∫–∞: `KeyError: 'ContainerConfig'`
–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ —Ü—é –ø–æ–º–∏–ª–∫—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É `docker-compose up`, –≤–∏–∫–æ–Ω–∞–π—Ç–µ:

```bash
# –ó—É–ø–∏–Ω—ñ—Ç—å —ñ –≤–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞—Ä–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose down

# –í–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞—Ä–∏–π –æ–±—Ä–∞–∑ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –∞–ª–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
docker rmi n8n-backup-manager 2>/dev/null || true

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∑–Ω–æ–≤—É
docker-compose up -d --build
```

–Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è, —Å–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –æ—á–∏—Å—Ç–∏—Ç–∏:
```bash
docker stop n8n-backup-manager 2>/dev/null || true
docker rm n8n-backup-manager 2>/dev/null || true
docker-compose up -d --build
```

## 7. –ü–æ—á–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (Initial Setup)

–ü—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ `http://your-server-ip:3000`:

1.  –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **"First Time Setup"** (–ø—ñ–¥ –∫–Ω–æ–ø–∫–æ—é Login).
2.  **–õ–æ–≥—ñ–Ω —Ç–∞ –ø–∞—Ä–æ–ª—å**: –ü—Ä–∏–¥—É–º–∞–π—Ç–µ **–ù–û–í–Ü** –ª–æ–≥—ñ–Ω —Ç–∞ –ø–∞—Ä–æ–ª—å –¥–ª—è —Ü—å–æ–≥–æ "Backup Manager".
    - –¶–µ **–ù–ï** –≤–∞—à—ñ –¥–∞–Ω—ñ –≤—ñ–¥ n8n.
    - –¶–µ –æ–∫—Ä–µ–º–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–ª—è –¥–æ—Å—Ç—É–ø—É —Å–∞–º–µ –¥–æ —Ü—ñ—î—ó –ø–∞–Ω–µ–ª—ñ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –±–µ–∫–∞–ø–∞–º–∏.
3.  –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Create Admin".
4.  –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —É–≤—ñ–π–¥—ñ—Ç—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—ñ –Ω–æ–≤—ñ –¥–∞–Ω—ñ.

## 8. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è HTTPS —á–µ—Ä–µ–∑ Nginx Proxy Manager

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `backup.muronero.com`) –∑ HTTPS —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º:

### 8.1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–∑–≤—É –º–µ—Ä–µ–∂—ñ NPM

–î—ñ–∑–Ω–∞–π—Ç–µ—Å—è, —è–∫–∞ –º–µ—Ä–µ–∂–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–∞—à–∏–º Nginx Proxy Manager:

```bash
docker network ls
```

–®—É–∫–∞–π—Ç–µ –º–µ—Ä–µ–∂—É –∑ –Ω–∞–∑–≤–æ—é —Ç–∏–ø—É `nginx_proxy_manager_default`, `npm_default`, –∞–±–æ `public`.

### 8.2. –û–Ω–æ–≤—ñ—Ç—å docker-compose.yml

–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `docker-compose.yml` –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ —Ç–∞ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—ñ–Ω –º—ñ—Å—Ç–∏—Ç—å —Å–µ–∫—Ü—ñ—é `networks`:

```yaml
version: '3.8'
services:
  backup-manager:
    build: .
    container_name: n8n-backup-manager
    restart: unless-stopped
    ports:
      - "3000:3000"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./backups:/app/backups
      - ./data:/app/data
    environment:
      - JWT_SECRET=change_this_secret
    networks:
      - default
      - npm_public

networks:
  npm_public:
    external: true
    name: nginx_proxy_manager_default  # –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à—É –Ω–∞–∑–≤—É –º–µ—Ä–µ–∂—ñ
```

**–í–∞–∂–ª–∏–≤–æ:** –Ø–∫—â–æ –≤–∞—à–∞ –º–µ—Ä–µ–∂–∞ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è —ñ–Ω–∞–∫—à–µ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `npm_default` –∞–±–æ `public`), –∑–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è `name:` –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–µ.

### 8.3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker-compose down
docker-compose up -d
```

### 8.4. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Proxy Host –≤ Nginx Proxy Manager

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å **Nginx Proxy Manager** (–∑–∞–∑–≤–∏—á–∞–π `http://your-server-ip:81`)
2. –£–≤—ñ–π–¥—ñ—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É
3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ —Ä–æ–∑–¥—ñ–ª—É **Hosts ‚Üí Proxy Hosts**
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **Add Proxy Host**

#### –í–∫–ª–∞–¥–∫–∞ "Details":
- **Domain Names:** `backup.muronero.com` (–≤–∞—à –¥–æ–º–µ–Ω)
- **Scheme:** `http` (–Ω–µ https!)
- **Forward Hostname / IP:** `n8n-backup-manager` (–Ω–∞–∑–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
- **Forward Port:** `3000`
- **Cache Assets:** ‚úÖ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- **Block Common Exploits:** ‚úÖ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
- **Websockets Support:** ‚úÖ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

#### –í–∫–ª–∞–¥–∫–∞ "SSL":
- **SSL Certificate:** –í–∏–±–µ—Ä—ñ—Ç—å **Request a new SSL Certificate**
- **Force SSL:** ‚úÖ (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ HTTP ‚Üí HTTPS)
- **HTTP/2 Support:** ‚úÖ
- **HSTS Enabled:** ‚úÖ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –±–µ–∑–ø–µ–∫–∏)
- **Email Address for Let's Encrypt:** –í–≤–µ–¥—ñ—Ç—å –≤–∞—à—É email –∞–¥—Ä–µ—Å—É
- **I Agree to the Let's Encrypt Terms of Service:** ‚úÖ

5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Save**

### 8.5. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ DNS

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ DNS –∑–∞–ø–∏—Å –¥–ª—è –≤–∞—à–æ–≥–æ –¥–æ–º–µ–Ω—É –≤–∫–∞–∑—É—î –Ω–∞ IP-–∞–¥—Ä–µ—Å—É —Å–µ—Ä–≤–µ—Ä–∞:

- **–¢–∏–ø –∑–∞–ø–∏—Å—É:** A
- **–Ü–º'—è:** `backup` (–∞–±–æ `@` –¥–ª—è –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –¥–æ–º–µ–Ω—É)
- **–ó–Ω–∞—á–µ–Ω–Ω—è:** IP-–∞–¥—Ä–µ—Å–∞ –≤–∞—à–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

### 8.6. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ: **https://backup.muronero.com**

–í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏:
- ‚úÖ –ó–µ–ª–µ–Ω–∏–π –∑–∞–º–æ—á–æ–∫ (HTTPS –∞–∫—Ç–∏–≤–Ω–∏–π)
- ‚úÖ –°—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É Backup Manager
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∑ HTTP –Ω–∞ HTTPS

**–í—ñ—Ç–∞—î–º–æ!** –í–∞—à Backup Manager —Ç–µ–ø–µ—Ä –¥–æ—Å—Ç—É–ø–Ω–∏–π —á–µ—Ä–µ–∑ –±–µ–∑–ø–µ—á–Ω–µ HTTPS –∑'—î–¥–Ω–∞–Ω–Ω—è! üéâ

---

## 9. –û—á–∏—â–µ–Ω–Ω—è –ø–∞–ø–∫–∏ backups (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ—á–∏—Å—Ç–∏—Ç–∏ –ø–∞–ø–∫—É –∑ –±–µ–∫–∞–ø–∞–º–∏:

```bash
cd /opt/n8n-backup  # –∞–±–æ –≤–∞—à —à–ª—è—Ö –¥–æ –ø—Ä–æ–µ–∫—Ç—É
rm -rf backups/*
```

**–£–≤–∞–≥–∞:** –¶—è –∫–æ–º–∞–Ω–¥–∞ –≤–∏–¥–∞–ª–∏—Ç—å **–≤—Å—ñ** —Ñ–∞–π–ª–∏ –±–µ–∫–∞–ø—ñ–≤ –±–µ–∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è!
